=== Cross_site_Scripting_and_HTML_Injection.pdf ===
Total Pages: 17
============================================================

 
 
 
 
XSS & HTMLi are a input validation 
vulnerabilities, If the application processes 
these inputs without restriction, it may 
lead to various attacks, including injection 
attacks, 
data 
leakage, 
and 
security 
bypasses. 
XSS & 
HTML 
Injection 
Input Validation Attacks 
CyberSapiens 

1 | P a g e  
 
                                                                                                                                                                                                                   
Table of Contents 
Type chapter title (level 1) ...................................................................................................................... 1 
Type chapter title (level 2) ................................................................................................................... 2 
Type chapter title (level 3) ............................................................................................................... 3 
Type chapter title (level 1) ...................................................................................................................... 4 
Type chapter title (level 2) ................................................................................................................... 5 
Type chapter title (level 3) ............................................................................................................... 6 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

2 | P a g e  
 
Cross-site Scripting (XSS) 
Cross-Site Scripting (XSS) vulnerabilities pose significant security risks in web 
applications. By exploiting XSS, attackers can inject malicious scripts into web pages 
that other users view. When these scripts run, they execute in the context of the 
targeted user’s browser, potentially compromising sensitive information, user 
sessions, or even allowing the attacker to control user accounts.  
Summary of XSS Types 
Type 
Persistence 
Location 
Example Usage 
Stored XSS 
Persistent 
Server-side 
Malicious script in comments or 
profiles 
Reflected XSS 
Non-
Persistent 
Server-side 
Malicious URL in a phishing link 
DOM-Based 
XSS 
Non-
Persistent 
Client-side 
(DOM) 
Script executed directly in the 
browser 
 
Types of XSS 
1. Stored XSS (Persistent XSS): 
o 
Description: In a Stored XSS attack, malicious code is permanently 
stored on a server (e.g., in a database or on the server’s filesystem). 
This typically happens in areas where users can submit content, like 
comments, forums, or profiles. 
o 
Impact: Whenever a user visits the page with the injected script, it 
executes in their browser without needing them to interact with the 
page in a special way. 
o 
Example: A comment section on a blog where the attacker leaves a 
comment containing malicious JavaScript. Every user who reads the 
comment will trigger the script. 
2. Reflected XSS (Non-Persistent XSS): 
o 
Description: In Reflected XSS, the malicious script is part of the URL or 
a form input and is reflected back to the user by the server. The script 

3 | P a g e  
 
isn’t stored on the server but instead is executed by manipulating a 
URL or form submission. 
o 
Impact: The attacker typically needs to trick the user into clicking a 
link that contains the malicious code in its URL. Once clicked, the 
injected script will execute on the user’s side. 
o 
Example: An attacker sends a phishing email with a link containing 
malicious code in the URL. When the user clicks on it, the website 
reflects the script back in the response, executing it in the user's 
browser. 
3. DOM-Based XSS (Client-Side XSS): 
o 
Description: DOM-Based XSS happens entirely on the client side and 
doesn’t involve sending malicious input to the server. Instead, it 
leverages JavaScript in the user’s browser, manipulating the DOM 
(Document Object Model) to execute the attack. 
o 
Impact: Unlike Stored or Reflected XSS, DOM-Based XSS directly alters 
the structure or content of the page without server interaction. It’s 
harder to detect since it doesn’t show up in server logs or interact 
directly with server scripts. 
o 
Example: If a webpage’s JavaScript takes a URL parameter and directly 
inserts it into the page without sanitization, an attacker could control 
this parameter to inject a script that modifies the page content. 
Each type requires its own prevention strategy, including sanitizing inputs, 
encoding outputs, and using security headers like Content Security Policy (CSP) to 
mitigate risk. 
Impacts of XSS Vulnerabilities 
1. Session Hijacking: Attackers can steal session cookies, which are used to 
authenticate users. Once an attacker has a valid session cookie, they may 
impersonate the user and gain unauthorized access to the user’s account. 
2. Credential Theft: XSS allows attackers to create fake login forms or redirect 
users to phishing pages, tricking them into entering credentials that 
attackers can capture. 
3. Malware Distribution: Attackers can leverage XSS vulnerabilities to inject 
scripts that redirect users to malicious sites, download malware, or execute 
other harmful code on the user’s machine. 
4. Defacement and Information Manipulation: XSS can allow attackers to change 
the content or appearance of a webpage, showing users fraudulent or 
misleading information. 

4 | P a g e  
 
5. Privilege Escalation and Account Takeover: Attackers may use XSS to perform 
unauthorized actions on behalf of the victim, such as transferring funds or 
modifying settings. 
Real-World Examples of XSS Attacks 
1. Twitter Worm (2009): 
o 
Description: In 2009, Twitter suffered a widely publicized XSS attack 
known as the "StalkDaily Worm." The attack leveraged a Stored XSS 
vulnerability on Twitter's website. The worm spread when users 
viewed tweets containing malicious JavaScript that automatically 
posted more infected tweets. 
o 
Impact: The attack resulted in a large-scale Twitter worm that self-
replicated by exploiting the XSS vulnerability. It compromised user 
accounts and disrupted the platform until Twitter was able to patch 
the vulnerability. 
2. Samy MySpace Worm (2005): 
o 
Description: One of the earliest and most famous XSS attacks, the 
Samy Worm, targeted MySpace. A user named Samy Kamkar created a 
worm using an XSS vulnerability in the MySpace website. When users 
viewed his profile, a malicious script executed, automatically adding 
him to their friends list and spreading the script to their profiles as 
well. 
o 
Impact: Within 24 hours, over one million MySpace users were 
affected, making it one of the fastest-spreading social media worms. 
It showed the potential scale of an XSS attack and its ability to 
manipulate user data en masse. 
3. PayPal Stored XSS Vulnerability: 
o 
Description: In 2019, security researchers discovered a Stored XSS 
vulnerability on the PayPal website that could be used to inject 
malicious JavaScript into the "secure" PayPal domain. 
o 
Impact: Attackers could have exploited this vulnerability to execute 
code on PayPal users’ accounts, potentially stealing payment 
information or redirecting them to phishing sites. Due to PayPal’s 
financial nature, such a vulnerability posed a significant risk for fraud 
and financial theft. 
4. British Airways Data Breach (2018): 
o 
Description: Attackers exploited a combination of vulnerabilities, 
including XSS, to skim payment information from British Airways 
customers. Although XSS was one element, it allowed attackers to 
inject scripts to capture payment card data entered by users. 

5 | P a g e  
 
o 
Impact: The breach affected around 380,000 transactions and resulted 
in a £20 million fine for British Airways, highlighting the financial and 
reputational damage XSS vulnerabilities can lead to. 
5. Yahoo Mail XSS Exploits: 
o 
Description: Yahoo Mail has historically had several XSS vulnerabilities 
reported. In one instance, an attacker could inject JavaScript through 
email contents, compromising the accounts of Yahoo Mail users when 
they viewed infected messages. 
o 
Impact: Attackers used these vulnerabilities to steal users’ emails, 
contacts, and personal information. This type of XSS attack exposed 
sensitive data from millions of users and showed the risks XSS poses 
to web-based email clients. 
How XSS Attacks Work 
• 
Payload Injection: The attacker injects a script (the payload) through an input 
field, URL parameter, or other vectors. 
• 
Execution: When another user views or interacts with the page, the malicious 
script executes in their browser. 
• 
Data Theft or Manipulation: The script can then read cookies, local storage, 
or perform actions that appear to come from the user’s account. 
 
Protecting Against XSS 
To defend against XSS, developers and security teams should: 
• 
Sanitize and Escape Inputs: Ensure that any user input displayed back on the 
webpage is sanitized and encoded. 

6 | P a g e  
 
• 
Use Content Security Policy (CSP): A properly configured CSP can restrict 
JavaScript execution and block the loading of malicious scripts. 
• 
Apply Secure Cookies: Mark cookies as HttpOnly to prevent JavaScript access, 
reducing the risk of session theft. 
• 
Use Framework Security Functions: Many frameworks (e.g., React, Angular) 
have built-in XSS protection mechanisms to reduce risks. 
HTMLi 
HTML Injection is a web security vulnerability that occurs when an attacker injects 
malicious HTML code into a vulnerable web page, altering the content or behaviour 
of the page. HTML Injection often exploits improper handling of user inputs, such 
as failing to sanitize or validate data before displaying it on the page. 
 
HTML Injection attacks are similar to XSS threats and can lead to various impacts, 
including the display of misleading information, unauthorized actions on behalf of 
users, or even a complete compromise of the affected page. 
1. Reflected HTML Injection 
• 
Description: In reflected HTML injection, the malicious HTML code is injected 
into a request and reflected back in the page’s response. This type typically 
affects only the user who directly interacts with the crafted URL or form. 
• 
Example: A search bar on a website that directly displays user inputs without 
sanitizing them. If a user enters <h1>Hacked!</h1> into the search bar, 

7 | P a g e  
 
and the page reflects it back without filtering, the user will see "Hacked!" 
displayed in an H1 header. 
• 
Impact: Limited to individual users who click or interact with a specific link 
containing the injected HTML code. However, attackers can deceive users by 
sending them links to modified, fake content or impersonate the website. 
2. Stored HTML Injection 
• 
Description: In stored HTML injection, the injected HTML code is saved to the 
server’s database and displayed every time the affected page is loaded. 
Stored HTML injection is more severe as it affects all users who view the 
compromised page. 
• 
Example: A comment section on a blog where users can post comments. If 
the application does not sanitize HTML input, an attacker could post a 
comment containing HTML tags, such as <marquee>Malicious 
Message</marquee>. This message will appear with a scrolling effect for all 
users who visit the blog. 
• 
Impact: Since the injected code is stored on the server, it can affect a large 
number of users. It could lead to widespread misinformation, defacement of 
the website, or even facilitate phishing attacks. 
Impact of HTML Injection 
• 
Content Manipulation: HTML injection allows attackers to alter how a page 
looks, adding misleading or malicious content. 
• 
Phishing Attacks: Attackers can use HTML injection to insert fake login 
forms, tricking users into entering sensitive information like usernames and 
passwords. 
• 
Reputational Damage: Defaced or malicious content displayed on a website 
can harm the brand's reputation and decrease user trust. 
• 
Facilitating Other Attacks: HTML Injection could be used as an entry point for 
other attacks, such as Cross-Site Scripting (XSS), if JavaScript can also be 
injected. 
Real-Time Examples of HTML Injection 
1. Example in an E-commerce Site's Search Feature: 
o 
Many e-commerce sites allow users to search for items. Suppose the 
search function displays the user’s search query on the result page 
without sanitizing it. An attacker could inject HTML code in the search 
field to change the layout or display misleading information about 
products. 

8 | P a g e  
 
2. Example in a Message Board: 
o 
On a message board that allows users to post HTML content, if proper 
validation is not implemented, an attacker could post a message 
containing HTML that affects all users who view the board. For 
instance, inserting <style>body {background-color: red;}</style> 
would turn the background color of the page to red for every viewer, 
potentially alarming users and harming the site’s credibility. 
Prevention Techniques 
1. Input Sanitization and Validation: Validate and sanitize all user input before 
rendering it on the page. 
2. Encoding Output: Encode any HTML content to prevent HTML tags from 
being interpreted as code. 
3. Content Security Policy (CSP): Use CSP to restrict the types of content loaded 
on your website. 
4. Use Web Application Firewalls (WAFs): WAFs can help detect and block 
malicious HTML injection attempts. 
Input Validation Attacks 
Input validation attacks exploit vulnerabilities in applications that fail to properly 
validate, sanitize, or restrict user input before processing it. When an application 
does not enforce strict checks on user-provided data, attackers can manipulate 
inputs to achieve unintended results, often leading to unauthorized access, data 
manipulation, or code execution. 
How Input Validation Attacks Work 
Input validation attacks target applications by sending unexpected, malformed, or 
malicious data through forms, URL parameters, API requests, or any input field. If 
the application processes these inputs without restriction, it may lead to various 
attacks, including injection attacks, data leakage, and security bypasses. 
Types of Input Validation Attacks 
1. SQL Injection (SQLi) 
o 
Description: In SQL injection, attackers insert malicious SQL 
commands into input fields (e.g., login forms or search fields) that 
interact with the application’s database. 

9 | P a g e  
 
o 
Example: Entering OR '1'='1' in a login field could bypass 
authentication if the application does not validate and sanitize SQL 
inputs. 
o 
Impact: Can lead to unauthorized access, data breaches, or even 
deletion of critical data. 
2. Cross-Site Scripting (XSS) 
o 
Description: In XSS attacks, attackers inject malicious JavaScript into 
web pages that are viewed by other users. This typically happens if 
user-generated content is not properly sanitized. 
o 
Example: Posting <script>alert('Hacked');</script> in a comment 
section displays a popup to all users viewing that page. 
o 
Impact: Can lead to account hijacking, data theft, or session hijacking, 
compromising user security. 
3. Command Injection 
o 
Description: Attackers can execute arbitrary system commands on a 
server by entering malicious inputs into fields processed by the 
server’s command line. 
o 
Example: If a web form takes a filename as input and appends it to a 
command without validation, an attacker could enter ; rm -rf / to 
delete files on the server. 
o 
Impact: Severe risk of data loss, server compromise, and potentially 
full control over the affected server. 
4. Path Traversal 
o 
Description: Path traversal attacks allow attackers to access files or 
directories outside the intended scope by using patterns like ../ in file 
path inputs. 
o 
Example: Entering ../../etc/passwd in an input field to retrieve the 
server’s password file, if the application lacks path restrictions. 
o 
Impact: Data exposure, including sensitive files, configuration files, 
and potentially user credentials. 
5. LDAP Injection 
o 
Description: This attack involves injecting malicious code into LDAP 
queries, which can modify directory service commands. 
o 
Example: Entering *)(|(userPassword=*)) in a search field to retrieve 
password fields of all users. 
o 
Impact: Unauthorized access to directory data, exposure of sensitive 
information, or account compromise. 
6. Email Header Injection 
o 
Description: In email header injection, attackers manipulate email 
headers to send emails on behalf of the server, potentially used for 
phishing or spam. 

10 | P a g e  
 
o 
Example: Injecting additional headers like \r\nCC: 
attacker@malicious.com into an email form allows sending an email to 
additional recipients. 
o 
Impact: Misuse of the email system for phishing or spam attacks, 
leading to reputational damage or compromised user accounts. 
Impact & Mitigation Measures 
Input validation attacks can severely compromise web application security. When 
applications do not validate and sanitize user inputs properly, attackers can exploit 
this vulnerability in various ways: 
1. Data Breaches 
o 
Attackers can gain unauthorized access to sensitive data, leading to 
breaches that compromise customer information, financial records, or 
proprietary data. 
o 
Example: SQL Injection attacks exploit unvalidated inputs to access or 
extract sensitive database information. 
2. System Compromise 
o 
Input validation flaws can allow attackers to execute arbitrary 
commands on the server, potentially leading to a complete 
compromise of the system. 
o 
Example: Command Injection vulnerabilities allow attackers to run 
malicious commands on the server, impacting the integrity of the 
server. 
3. Session Hijacking and Phishing 
o 
Cross-Site Scripting (XSS) attacks can be executed when applications 
don't validate and sanitize inputs, enabling attackers to steal session 
cookies, impersonate users, or create phishing prompts. 
o 
Example: XSS attacks inject JavaScript that can capture cookies and 
other session data, leading to unauthorized account access. 
4. Malware Distribution 
o 
Poor input validation may allow attackers to inject malicious scripts, 
causing users to inadvertently download malware. 
o 
Example: An attacker injects a download link for malware in a 
comment section that is displayed to all users. 
5. Denial of Service (DoS) 
o 
Attackers can exploit input validation vulnerabilities to overload the 
server, causing the application to crash or slow down, impacting 
availability. 

11 | P a g e  
 
o 
Example: Large input data, unfiltered and unvalidated, may exhaust 
system resources, leading to DoS attacks. 
6. Reputational Damage 
o 
When vulnerabilities are exploited, users may lose trust in the 
platform, leading to reputational damage, lost business, and 
decreased customer confidence. 
Mitigation Measures for Input Validation Attacks 
Mitigating input validation attacks requires implementing secure coding practices, 
using the right tools, and following defense-in-depth strategies to ensure inputs 
are handled securely. 
1. Input Sanitization and Validation 
• 
Description: Ensure all inputs meet expected formats, types, and lengths. 
• 
Implementation: 
o 
Use allowlisting: Only allow specific acceptable characters or patterns. 
o 
Enforce proper input lengths and types (e.g., integers for age). 
• 
Example: For a date field, validate to accept only date formats (e.g., YYYY-
MM-DD). 
2. Use of Parameterized Queries and ORM 
• 
Description: Parameterized queries ensure user inputs are treated as data, 
not executable code, which is essential for SQL and similar queries. 
• 
Implementation: Use prepared statements and ORM (Object-Relational 
Mapping) libraries for database interactions. 
• 
Example: In SQL, replace dynamic query strings with parameterized queries 
like SELECT * FROM users WHERE id = ?. 
3. Output Encoding 
• 
Description: Encode outputs before displaying user-provided data on web 
pages to prevent XSS. 
• 
Implementation: Use HTML entity encoding for data displayed in HTML 
context, and JavaScript escaping for script context. 
• 
Example: Encode <script>alert('XSS');</script> as text so it displays safely 
without executing. 

12 | P a g e  
 
4. Content Security Policy (CSP) 
• 
Description: A CSP restricts the sources from which content can be loaded, 
minimizing the impact of XSS attacks. 
• 
Implementation: Set CSP headers to specify allowed sources for scripts, 
images, and styles. 
• 
Example: A CSP like Content-Security-Policy: script-src 'self'; limits scripts to 
those from the site itself. 
5. Input Encoding and Escaping 
• 
Description: Encode and escape input data to prevent special characters from 
being interpreted as code or commands. 
• 
Implementation: Use functions like htmlspecialchars() in PHP or similar 
encoding methods in other languages. 
• 
Example: Encode special characters like <, >, and & to prevent HTML 
injection. 
6. Security Testing and Scanning Tools 
• 
Description: Regularly scan applications for input validation vulnerabilities 
using automated security tools. 
• 
Implementation: Integrate tools such as OWASP ZAP or Burp Suite for 
dynamic analysis, and SonarQube or Checkmarx for static analysis. 
• 
Example: Run OWASP ZAP to simulate input validation attacks like SQLi and 
XSS. 
7. Implement Web Application Firewall (WAF) 
• 
Description: WAFs filter and block malicious traffic before it reaches the 
application. 
• 
Implementation: Configure WAFs to detect and prevent common input-based 
attacks like SQL injection and XSS. 
• 
Example: Cloudflare WAF can block common injection patterns and known 
attack vectors. 
8. Regular Code Reviews and Secure Coding Practices 
• 
Description: Conduct code reviews to identify input validation flaws early in 
the development process. 
• 
Implementation: Follow secure coding guidelines (e.g., OWASP Secure Coding 
Practices) and ensure input validation is a priority. 

13 | P a g e  
 
• 
Example: Code reviews focus on areas where user input is processed and 
check for proper validation methods. 
9. Implement HTTP Headers 
• 
Description: Security headers, like X-XSS-Protection and X-Content-Type-
Options, add layers of protection to block certain input validation attacks. 
• 
Implementation: Configure these headers in the web server (e.g., Apache, 
Nginx). 
• 
Example: Set X-Content-Type-Options: nosniff to prevent browsers from 
interpreting files as different MIME types. 
10. Continuous Monitoring and Logging 
• 
Description: Monitor and log all interactions to detect and respond to 
suspicious activities in real time. 
• 
Implementation: Set up real-time alerts for unusual patterns in user inputs 
and interaction logs. 
• 
Example: Monitor for repeated injection patterns or unusual file path 
requests, which may indicate an attack attempt. 
 
XSS Vulnerability: 
 
 

14 | P a g e  
 
 
 
 
 
 

15 | P a g e  
 
 
 
 

16 | P a g e  
 
 
 
 
References & Resources 
https://portswigger.net/web-security/all-labs#cross-site-scripting  
https://www.acunetix.com/websitesecurity/cross-site-scripting/  
GitHub Payloads 
https://github.com/payloadbox/xss-payload-list/blob/master/Intruder/xss-payload-list.txt 
https://github.com/payloadbox/xss-payload-list  
 
