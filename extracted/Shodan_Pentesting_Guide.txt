7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
1/82
Shodan Pentesting Guide
PENTESTING
Delving deep into Shodan’s mine
Community Homepage

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
2/82
Shodan is a tool for searching devices connected to the internet. Unlike search
engines which help you ¤nd websites, Shodan helps you ¤nd information about
desktops, servers, IoT devices, and more. This information includes metadata
such as the software running on each device.
Common uses of Shodan include Network Security, Market Research,
Cyber Risk, scanning IoT devices, and Tracking Ransomware. This guide
will focus on comprehensively covering these applications in a pentesting
context.
Table of Contents [ show ]
Shodan is a tool that lets you explore the internet; discovering connected
devices or network services, monitoring network security, making global
statistics and so on.
What is Shodan?
Shodan is a search engine for Internet-connected devices. It was
created by John C. Matherly (@achillean) in 2009.

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
3/82
The Shodan’s website/database references results from extensive port
scanning of the Internet.
Shodan interfaces
This section will show you the various ways you can connect to Shodan.
It’s possible to interact with Shodan via the well known website, the o¢cial
python command-line interface tool and library, a variety of community driven
libraries for many languages and also the o¢cial REST API.
CLI tool
The o¢cial shodan command-line interface (CLI) is written in python, for quick
usage in your terminal.
Install
In a virtual python environment like pyenv:
$ easy_install shodan
On BlackArch you can also install the following package:
# pacman -S python-shodan
Once you have installed shodan CLI tool, to setup your API token just do:
$ shodan init <YOUR_API_KEY>
Command overview
A dozen of straightforward commands are available:
–help

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
4/82
$ shodan –help
Usage: shodan [OPTIONS] COMMAND [ARGS]…
Options:
 -h, –help  Show this message and exit.
Commands: 
alert       Manage the network alerts for your account. 
convert     Convert the given input data file into a different 
format. 
count       Returns the number of results for a search. 
data        Bulk data access to Shodan. 
domain      View all available information for a domain. 
download    Download search results and save them in a compressed 
JSON file. 
honeyscore  Check whether the IP is a honeypot or not. 
host        View all available information for an IP address. 
info        Shows general information about your account. 
init        Initialize the Shodan command-line. 
myip        Print your external IP address. 
org         Manage your organization’s access to Shodan. 
parse       Extract information out of compressed JSON files. 
radar       Real-Time Map of some results as Shodan finds them. 
scan        Scan an IP/ netblock using Shodan. 
search      Search the Shodan database. 
stats       Provide summary information about a search query. 
stream      Stream data in real-time. 
version     Print version of this tool.
info
If you have setup your API token, you can check the number of credits you have
left:

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
5/82
$ shodan info 
Query credits available: 100 
Scan credits available: 100
Query credits are used to search Shodan and scan credits are used to scan IPs.
A search request consumes 1 query credit and scanning 1 IP consumes 1
scan credit.
version
When writing this article I was using shdoan 1.21.2:
$ shodan version 
1.21.2
count
Returns the number of results for a search query.
$ shodan count openssh 
23128 
$ shodan count openssh 7 
219
download
Search Shodan and download the results into a ¤le where each line is a JSON
banner.
By default it will only download 1,000 results, if you want to download more
look at the –limit ¥ag.
The download command lets you save the results and process them afterwards
using the parse command.

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
6/82
So if you often search for the same queries it will help you save credits.
The export credits are used to download data from the website at the rate of: 1
export credit lets you download up to 10,000 results. They are single-use which
means that once you use them they don’t automatically renew at the start of
the month.
But if you don’t have export credits, you can use 1 query credit to save 100
results.
$ shodan download -h 
Usage: shodan download [OPTIONS] <filename> <search query> 
Download search results and save them in a compressed JSON file. 
Options: 
--limit INTEGER The number of results you want to download. -1 to 
download 
all the data possible. 
--skip INTEGER The number of results to skip when starting the 
download. 
-h, --help Show this message and exit.
For example here I will download 1000 results of the query openssh:
$ shodan download openssh-data openssh 
Search query: openssh 
Total number of results: 23128 
Query credits left: 100 
Output file: openssh-data.json.gz 
[###################################-] 99% 00:00:00 
Saved 1000 results into file openssh-data.json.gz

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
7/82
After the download you can check how many credits you have left:
$ shodan info 
Query credits available: 95 
Scan credits available: 100
host
See information about the host such as where it’s located, what ports are
open and which organization owns the IP.
$ shodan host 1.1.1.1 
1.1.1.1 
Hostnames: one.one.one.one 
Country: Australia 
Organization: Mountain View Communications 
Updated: 2020-01-21T22:26:00.168041 
Number of open ports: 3 
Ports: 
53/udp 
80/tcp 
443/tcp 
|-- SSL Versions: -SSLv2, -SSLv3, TLSv1, TLSv1.1, TLSv1.2, TLSv1.3 
$ shodan host 138.201.81.199 
138.201.81.199 
Hostnames: apollo.archlinux.org 
Country: Germany 
Organization: Hetzner Online GmbH 
Updated: 2020-01-21T03:02:11.476262 
Number of open ports: 4 

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
8/82
myip
Returns your Internet-facing IP address.
$ shodan myip 
199.30.49.210
parse
Use parse to analyze a ¤le that was generated using the download
command.
It lets you ¤lter out the ¤elds that you’re interested in, convert the JSON to a
CSV and is friendly for pipe-ing to other scripts.
$ shodan parse -h 
Usage: shodan parse [OPTIONS] <filenames> 
Extract information out of compressed JSON files. 
Options: 
--color / --no-color 
--fields TEXT List of properties to output. 
-f, --filters TEXT Filter the results for specific values using 
Ports: 
22/tcp OpenSSH (8.1) 
25/tcp Postfix smtpd 
80/tcp nginx (1.16.1) 
443/tcp nginx (1.16.1) 
|-- SSL Versions: -SSLv2, -SSLv3, -TLSv1, -TLSv1.1, TLSv1.2, 
TLSv1.3

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
9/82
key:value 
pairs. 
-O, --filename TEXT Save the filtered results in the given file 
(append if 
file exists). 
--separator TEXT The separator between the properties of the 
search 
results. 
-h, --help Show this message and exit.
The following command outputs ¤ltered data for the previously downloaded
openssh data:
$ shodan parse --fields location.country_code3,ip_str,hostnames -f 
port:2222 openssh-data.json.gz 
ITA 89.107.109.247 
HUN 193.6.173.187 
FRA 77.87.111.110 pro-sip1.srv.proceau.net 
USA 50.210.94.33 
USA 35.130.36.118 035-130-036-118.biz.spectrum.com 
AUT 80.120.19.180 
JPN 124.155.95.212 v095212.ppp.asahi-net.or.jp 
POL 83.144.70.114 83-144-70-114.static.chello.pl 
BGR 84.238.200.8 
AUT 80.120.19.168 
USA 162.211.126.140 
CAN 76.10.173.222 mail.nanoman.ca 
USA 24.172.82.71 rrcs-24-172-82-71.midsouth.biz.rr.com 
AUT 80.120.19.182 
ITA 188.14.96.151 host151-96-static.14-188-
b.business.telecomitalia.it 
USA 216.67.111.198 216-67-111-198.static.acsalaska.net 
USA 73.179.238.221 c-73-179-238-221.hsd1.fl.comcast.net 

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
10/82
HKG 113.28.18.59 113-28-18-59.static.imsbiz.com 
$ shodan parse --fields 
port,ip_str,location.city,location.postal_code -f 
location.country_code:FR --separator , openssh-data.json.gz 
22,188.92.65.5,Hésingue,68220 
2222,77.87.111.110,, 
22,51.89.105.163,, 
22,5.135.218.249,, 
22,93.177.70.142,, 
2222,81.250.129.207,Paris,75116 
22,51.255.85.97,, 
22,193.52.218.40,Aix-en-provence,13090 
22,51.77.112.86,, 
22,149.202.19.41,, 
22,5.39.117.104,, 
22,195.154.53.223,Beaumont,95260 
22,37.71.132.198,, 
22,178.33.71.35,, 
22,212.83.188.179,Jouy-le-moutier,95280 
2222,195.200.166.216,Berre-l'etang,13130 
22,82.251.157.165,Paris,75004
search
This command lets you search Shodan and view the results in a terminal-
friendly way.
By default it will display the IP, port, hostnames and data. You can use the –
¤elds parameter to print whichever banner ¤elds you’re interested in.
A simple query won’t consume any credits but if you use a search ¤lter or
request page 2 and beyond, credits will be consumed.

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
11/82
$ shodan search -h 
Usage: shodan search [OPTIONS] <search query> 
Search the Shodan database 
Options: 
--color / --no-color 
--fields TEXT List of properties to show in the search results. 
--limit INTEGER The number of search results that should be 
returned. 
Maximum: 1000 
--separator TEXT The separator between the properties of the 
search 
results. 
-h, --help Show this message and exit.
Example of query that won’t cost credits:
$ shodan search --fields ip_str,port,os smb 
156.226.167.81 445 Windows Server 2008 R2 Datacenter 7601 Service 
Pack 1 
156.243.104.194 445 Windows Server 2008 R2 Enterprise 7601 Service 
Pack 1 
91.230.243.89 445 Windows 10 Pro 16299 
85.3.170.18 445 Windows 6.1 
213.238.170.132 445 Windows Server 2012 R2 Standard 9600 
154.208.176.81 445 Windows Server 2008 R2 Enterprise 7601 Service 
Pack 1 
103.235.171.78 445 Windows Server 2016 Datacenter 14393 
102.130.40.85 445 Windows Server 2016 Standard 14393 
50.3.151.113 445 Windows Server 2012 R2 Standard 9600 
220.241.112.233 445 Windows Server 2019 Standard 17763 
100.27.15.229 445 WWindows Server 2012 R2 Standard 9600 

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
12/82
212.71.136.11 445 Unix 
156.255.174.225 445 Windows Server 2008 R2 Datacenter 7601 Service 
Pack 1 
156.232.162.239 445 WWindows Server 2008 R2 Enterprise 7601 
Service Pack 1 
186.210.102.132 445 Unix 
154.94.153.34 445 Windows Server 2012 R2 Datacenter 9600 
213.130.28.31 445 Windows 6.1
Example of query that will cost 1 credit (because using a ¤lter):
$ shodan search --fields ip_str,port,org,info product:mongodb 
165.22.3.203 27017 Digital Ocean 
213.159.208.76 27017 JSC The First 
209.6.48.11 27017 RCN 
23.239.0.110 27017 Linode 
52.220.230.134 27017 Amazon.com 
47.91.139.188 27017 Alibaba 
159.203.169.196 27017 Digital Ocean 
49.233.135.180 27017 Tencent cloud computing 
122.228.113.75 27017 WENZHOU, ZHEJIANG Province, P.R.China. 
106.14.42.66 27017 Hangzhou Alibaba Advertising Co.,Ltd. 
59.108.91.3 27017 Beijing Founder Broadband Network Technology 
Co.,L 
115.29.176.18 27017 Hangzhou Alibaba Advertising Co.,Ltd. 
148.251.46.75 27017 Hetzner Online GmbH 
3.121.222.150 27017 Amazon.com 
47.75.211.162 27017 Alibaba 
200.219.217.122 27017 Equinix Brazil
scan
Scan an IP/ netblock using Shodan.

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
13/82
$ shodan scan -h 
Usage: shodan scan [OPTIONS] COMMAND [ARGS]... 
Scan an IP/ netblock using Shodan. 
Options: 
-h, --help Show this message and exit. 
Commands: 
internet Scan the Internet for a specific port and protocol using 
the... 
list Show recently launched scans 
protocols List the protocols that you can scan with using Shodan. 
status Check the status of an on-demand scan. 
submit Scan an IP/ netblock using Shodan.
Launching a scan will cost credits:
1 scan credit lets you scan 1 IP
By default a scan result will be displayed to stdout but you can save it to a ¤le
to be able to parse it later.
$ shodan scan submit --filename 104.27.154.244_scan.json.gz 
104.27.154.244
If the host has already been scanned in the last 24 hours, you won’t be
able to scan it again without an Enterprise grade plan.
$ shodan scan submit --filename 104.27.154.244_scan.json.gz 
104.27.154.244 

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
14/82
Starting Shodan scan at 2020-01-22 23:46 - 100 scan credits left 
No open ports found or the host has been recently crawled and cant 
get scanned again so soon.
You are also able to see the scans you previously launched with their ID and
status:
$ shodan scan list 
# 2 Scans Total - Showing 10 most recent scans: 
# Scan ID Status Size Timestamp 
zmWj3RNgiPbiQjx9 PROCESSING 1 2020-01-22T22:49:39.037000 
8J9yu7jqTQO7AIiP PROCESSING 1 2020-01-22T22:46:34.790000
To save your scan results you are not forced to use –¤lename. You can simply
launch a scan without saving it, and download the results later thanks to the
scan ID:
$ shodan download --limit -1 scan-results.json.gz 
scan:zmWj3RNgiPbiQjx9
As scan are done asynchronously, you can check the status of a scan at any
moment.
$ shodan scan status zmWj3RNgiPbiQjx9 
DONE
To see the scan ID when launching a scan you can use the verbose mode:
$ shodan scan submit --verbose 13.226.145.4  
 
Starting Shodan scan at 2020-01-23 00:00 - 97 scan credits left  
# Scan ID: 3z6Cqf1CCyVLtc6P 
# Scan status: DONE

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
15/82
Customers with an Enterprise Data License will be allowed to request a scan of
the entire Internet by simply specifying the port and protocol/module.
$ shodan scan internet 8080 wemo-http
Available protocols and modules can be listed with shodan scan protocols.
stats
Provide summary information about a search query
$ shodan stats -h 
Usage: shodan stats [OPTIONS] <search query> 
Provide summary information about a search query 
Options: 
--limit INTEGER The number of results to return. 
--facets TEXT List of facets to get statistics for. 
-O, --filename TEXT Save the results in a CSV file of the provided 
name. 
-h, --help Show this message and exit.
It seems that by default you will get only top 10 and not for all facets:
$ shodan stats nginx 
Top 10 Results for Facet: country 
US 13,598,596 
CN 6,013,993 
ZA 3,067,296 
DE 1,560,114 
HK 1,065,990 
RU 869,931 
FR 859,715 

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
16/82
GB 555,946 
NL 550,591 
JP 526,386 
Top 10 Results for Facet: org 
Amazon.com 1,897,943 
CloudInnovation infrastructure 1,288,280 
Leaseweb USA 1,200,146 
EGIHosting 1,131,973 
DXTL Tseung Kwan O Service 1,052,688 
Hangzhou Alibaba Advertising Co.,Ltd. 770,553 
Digital Ocean 749,221 
Asline Limited 680,364 
Power Line Datacenter 678,264 
Quantil Networks 585,935
But we can customize this behavior:
$ shodan stats --facets domain,port,asn --limit 5 nginx 
Top 5 Results for Facet: domain 
amazonaws.com 2,208,958 
scalabledns.com 435,980 
googleusercontent.com 308,114 
t-ipconnect.de 225,276 
your-server.de 180,711 
Top 5 Results for Facet: port 
80 10,019,366 
443 5,300,058 
5000 588,809 
5001 563,208 
8080 453,604 

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
17/82
Top 5 Results for Facet: asn 
as37353 2,447,679 
as35916 1,878,181 
as15003 1,508,786 
as16509 1,236,249 
as18779 1,132,180
Website
Main interface
The main interface of Shodan is the search engine.
It works like the search command of the CLI tool but with a fancy WebUI to
display the results. It shows a summary for each host, the total count of hosts
that matched the query like the count command of the CLI and some stats like
the stats command.

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
18/82
Once you have selected a host, you will be able to see a shot speci¤cation table,
vulnerabilities impacting the host, open ports and banners for open ports.
Downloading data
After you made a search, a Download Results button will be available:

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
19/82
Then you will be able to download the search results in JSON, CSV or XML.
Only the JSON format will contain the full data and be compatible with the
Shodan CLI tool. CSV format will only contain IP, port, banner, organization and
hostnames.

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
20/82
The XML format is deprecated by Shodan and consumes more space than
the JSON one.
You can then view your download history in the Downloads section.
Generating reports
The website lets you generate a report based o¡ of a search query.
The report contains graphs/ charts providing you a big picture view of how the
results are distributed across the Internet. This feature is free and available to
anyone.
To generate a report, click on the Create Report button from the search results
page:

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
21/82
Name your report:
Creating a report will usually take a few minutes, you will receive an email when
the report is ready with the link.
Else you can ¤nd all your previous reports on the report page.

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
22/82

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
23/82

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
24/82
A report is static and won’t update automatically.
Maps
The map interface to search the Shodan database works like the stats command
of the CLI but displays the results in an interactive map depending on the
physical location of the host.
As it won’t show more than 1000 results, you will have to zoom in and out or
move around to display other results
Images
Images is a searchable gallery of screenshots from crawled devices.

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
25/82
Image data is gathered from 5 di¡erent sources: VNC, Remote Desktop (RDP),
RTSP, Webcams and X Windows.
A has_screenshot:true ¤lter can be used in the global search engine to
keep only hosts that have a screenshot.
Exploits
Exploits is a search engine that looks for exploits across a variety of vulnerability
databases at once.

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
26/82
Developer dashboard
Your developer dashboard shows you your credits consumption and API plan.
Network monitor

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
27/82
Keep track of the devices that you have exposed to the Internet. Setup
noti¤cations, launch scans and gain complete visibility into what you have
connected.
The monitor dashboard let you tracks your devices, alert you if something
suspicious was detected, launch scan and display what’s found on synthetic
dashboard.
To begin with, add an IP, a range or a domain to monitor and choose a
noti¤cation service.
Then you can manage your assets, from here you can launch scans or modify
trigger rules.

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
28/82
You can select which kind of event will trigger an alert.

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
29/82
Then the dashboard shows the exposed services.

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
30/82
ICS radar
ICS Radar is a 3D map of Industrial Control Systems (ICS) devices found by
Shodan crawlers.

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
31/82
Honeypot score
The service called Honeypot or not? will attribute a Honeyscore to an IP address,
a probability of being a honeypot.
It’s just an abstraction of the API like the honeyscore command of the CLI:
$ shodan honeyscore 46.244.103.227 
Not a honeypot 
Score: 0.3
Shodan 2000
Sodan 2000 is a Tron-like interface that randomly displays an host.

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
32/82
Community queries
You can explore queries exported and shared by other users of the community.
The shared queries have a title, a description and tags so you can browse them
easily.

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
33/82
To share a query, click the Share Search button on a search result page.

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
34/82
REST API
Shodan comes with a REST API, it can be used to build a web application service
based on Shodan or create a wrapper library if none already exists in your
favorite language.
The base URL of the API is: https://api.shodan.io and all API methods are rate-
limited to 1 req/sec.
The API is authenticated so if you forget to provide your API key, you will get a
HTTP 401 error.
Here is an example of how you can query your API Plan Information with curl:
curl -s https://api.shodan.io/api-info?key={YOUR_API_KEY} | jq
{ 
"scan_credits": 95, 
"usage_limits": { 
"scan_credits": 100, 
"query_credits": 100, 

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
35/82
"monitored_ips": 16 
}, 
"plan": "dev", 
"https": false, 
"unlocked": true, 
"query_credits": 94, 
"monitored_ips": 2, 
"unlocked_left": 94, 
"telnet": false 
}
Another query to get a host information:
curl -s https://api.shodan.io/shodan/host/1.1.1.1?key=
{YOUR_API_KEY} | jq
{ 
"region_code": null, 
"ip": 16843009, 
"postal_code": null, 
"country_code": "AU", 
"city": null, 
"dma_code": null, 
"last_update": "2020-01-25T15:55:54.880090", 
"latitude": -33.494, 
"tags": [], 
"area_code": null, 
"country_name": "Australia", 
"hostnames": [ 
"one.one.one.one" 
], 
"org": "Mountain View Communications", 
"data": [ 

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
36/82
{ 
"_shodan": { 
"id": "f4218ca0-2728-4d7b-97f8-875f4f04149d", 
"options": { 
"referrer": "601b650e-3cc7-4189-babe-921fdf53a9e2", 
"hostname": "www.1yhaoduo.com" 
}, 
"ptr": true, 
"module": "http", 
"crawler": "d264629436af1b777b3b513ca6ed1404d7395d80" 
}, 
"hash": -237371161, 
"os": null, 
"opts": {}, 
"ip": 16843009, 
"isp": "APNIC and Cloudflare DNS Resolver project", 
"http": { 
"html_hash": 1145258596, 
"robots_hash": null, 
"redirects": [], 
"securitytxt": null, 
"title": "DNS resolution error | www.1yhaoduo.com | Cloudflare", 
"sitemap_hash": null, 
"waf": "CloudFlare", 
"robots": null, 
"favicon": null, 
"host": "www.1yhaoduo.com", 
...
Check the REST API Documentation for a complete description of all methods.
Language wrappers (libraries)

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
37/82
To interface your tool with the Shodan API you can use one of the wrapper
libraries.
The o¢cial one is made in Python, but there are also community libraries in
Ruby, PHP, Haskell, Rust, Perl, Node.js, Go, PowerShell, Java and C#.
I will give examples for those three:
Python – shodan-python
Ruby – shodanz
Node.js – shodan-client
Python – shodan-python
Installation
The installation is the same as for the CLI tool as the CLI tool is made upon the
python library, they are packaged together.
In a virtual python environment like pyenv:
$ easy_install shodan
On BlackArch you can also install the following package:
# pacman -S python-shodan
Then the API key will always be initialized like that in our code:
import shodan 
SHODAN_API_KEY = 'API key here' 
api = shodan.Shodan(SHODAN_API_KEY)
Note: the library is working for both python 2 and 3 but we’ll use only
python 3 as python 2 is deprecated.

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
38/82
Examples
Basic search:
try:  
    # Search Shodan  
    results = api.search('apache')  
 
    ## Show results  
    print('Results found: {}'.format(results['total']))  
    for result in results['matches']:  
        print('IP: {}'.format(result['ip_str']))  
    print(result['data'])  
    print('')  
except shodan.APIError as e:  
    print('Error: {}'.format(e))
Example of output:
IP: 65.99.237.196 
HTTP/1.1 200 OK 
Date: Sat, 25 Jan 2020 16:07:19 GMT 
Server: Apache 
Transfer-Encoding: chunked 
Content-Type: text/html 
IP: 212.72.184.58 
HTTP/1.1 200 OK 
Date: Sat, 25 Jan 2020 16:07:29 GMT 
Server: Apache/2.2.22 (Debian) mod_python/3.3.1 Python/2.7.3 
mod_ssl/2.2.22 OpenSSL/1.0.1t 

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
39/82
X-Powered-By: PHP/5.4.45-0+deb7u14 
Expires: Mon, 26 Jul 1997 05:00:00 GMT 
Cache-Control: no-store, no-cache, must-revalidate 
Pragma: no-cache 
Last-Modified: Sat, 25 Jan 2020 16:07:29 GMT 
Vary: Accept-Encoding 
Transfer-Encoding: chunked 
Content-Type: text/html 
IP: 208.109.44.217 
HTTP/1.1 404 Not Found 
Date: Sat, 25 Jan 2020 16:07:20 GMT 
Server: Apache 
Content-Length: 381 
Content-Type: text/html; charset=iso-8859-1
Available ports of a host:
try:  
  # Lookup the host  
  host = api.host('1.1.1.1')  
 
  # Print general info  
  print("""  
           IP: {}  
           Organization: {}  
           Operating System: {}  
        """.format(host['ip_str'], host.get('org', 'n/a'), 
host.get('os', 'n/a')))  
 
   # Print all banners  

7/16/2020
Shodan Pentesting Guide – TurgenSec Community
https://community.turgensec.com/shodan-pentesting-guide/
40/82
      for item in host['data']:  
            print("""  
                     Port: {}  
                     Banner: {}  
                  """.format(item['port'], item['data']))  
except shodan.APIError as e:  
    print('Error: {}'.format(e))
Example of output:
IP: 1.1.1.1  
Organization: Mountain View Communications  
Operating System: None  
Port: 80  
Banner: HTTP/1.1 409 Conflict  
Date: Sat, 25 Jan 2020 15:55:54 GMT  
Content-Type: text/html; charset=UTF-8  
Transfer-Encoding: chunked  
Connection: close  
Set-Cookie: __cfduid=d6241813d879cf2a39d03f5d6ce5a1abc1579967754; 
expires=Mon, 24-Feb-20 15:55:54 GMT; path=/; 
domain=.www.1yhaoduo.com; HttpOnly; SameSite=Lax  
Cache-Control: max-age=6  
Expires: Sat, 25 Jan 2020 15:56:00 GMT  
X-Frame-Options: SAMEORIGIN  
Vary: Accept-Encoding  
Server: cloudflare  
CF-RAY: 55ab6f23aee09cbd-AMS  
Port: 443  
